<h1>Bundle Adjustment</h1>

<equation>
  \Argmin{\Tf{W}{C}, \Pt{W}{P}}
    \Norm{\Vec{z} - \boldsymbol{\pi}(\Tf{W}{C}^{-1} \enspace \Pt{W}{P})}^{2}
</equation>

<equation>
  \Pt{W}{P} &= \Tf{W}{C}^{-1} \enspace \Pt{W}{P} \\
  % -- Project chain
  \boldsymbol{\pi} &= k(d(p(\Tf{W}{C}^{-1} \enspace \Pt{W}{P})))  \\
  % -- Project
  \Vec{x} &= p(\Tf{W}{C}^{-1} \enspace \Pt{W}{P}) =
    \begin{bmatrix}
      \Vec{x} \\
      \Vec{y} \\
      \Vec{z}
    \end{bmatrix} \\
  % -- Distort
  % -- Scale and center
  % -- dh / dp_C
  \dfrac{\partial{\pi}}{\partial{\Vec{x}_{C}}}
		&=
			\begin{bmatrix}
        1 / \Vec{Z}_{C} & 0 & -\Vec{X}_{C} / \Vec{Z}_{C}^{2} \\
				0 & 1 / \Vec{Z}_{C} & -\Vec{Y}_{C} / \Vec{Z}_{C}^{2}
			\end{bmatrix}
</equation>


<h2>Jacobian w.r.t Camera Pose, $\Tf{W}{C}$</h2>

<equation>
  \Pt{W}{F_{ij}}
  &=
    \Tf{W}{S}
    \enspace \Pt{S}{F_{i}} \\
  &=
    \Rot{W}{S}
    \enspace \Pt{S}{F_{i}}
		+ \Trans{W}{S}
</equation>

<equation>
  % -- dh / dp_W
  \dfrac{\partial{\pi}}{\partial{\Pt{W}}}
		&= \dfrac{\partial{\pi}}{\partial{\Pt{C}{F_{i}}}}
			 \enspace
			 \dfrac{\partial{\Pt{C}{F_{i}}}}{\partial{\Pt{W}}} \\
  % -- dp_C / dp_W
  \dfrac{\partial{\Pt{C}{F_{i}}}}{\partial{\Pt{W}}}
		&= \Rot{C}{W}
</equation>

<equation>
	% -- dh / dT_WS
  \dfrac{\partial{\pi}}{\partial{\Tf{W}{S}}}
    &=
		\begin{bmatrix}
			\dfrac{\partial{\pi}}{\partial{\dtheta}}
			\quad
			\dfrac{\partial{\pi}}{\partial{\Trans{W}{S}}}
		\end{bmatrix}
</equation>

<equation>
	% -- dh / dtheta_WS
  \dfrac{\partial{\pi}}{\partial{\dtheta}}
    &= \dfrac{\partial{\pi}}{\partial{\Pt{C}{F_{i}}}}
			 \enspace
       \dfrac{\partial{\Pt{C}{F_{i}}}}{\partial{\Pt{W}}}
			 \enspace
       \dfrac{\partial{\Pt{W}}}{\partial{\dtheta}} \\
	% -- dp_S / dtheta_WS
	\dfrac{\partial{\Pt{W}}}{\partial{\dtheta}}
  &= -\Skew{\rot\{\dtheta\} \enspace \Pt{S}{F_{i}}}
</equation>

<equation>
	% -- dh / dr_WS
  \dfrac{\partial{\pi}}{\partial{\Trans{W}{S}}}
    &= \dfrac{\partial{\pi}}{\partial{\Pt{C}{F_{i}}}}
			 \enspace
       \dfrac{\partial{\Pt{C}{F_{i}}}}{\partial{\Pt{W}}}
			 \enspace
       \dfrac{\partial{\Pt{W}}}{\partial{\Trans{W}{S}}} \\
	% -- dp_S / dr_WS
	\dfrac{\partial{\Pt{W}}}{\partial{\Trans{W}{S}}}
		&= \I
</equation>
